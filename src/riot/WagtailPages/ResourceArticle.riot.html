<ResourceArticle>
    <TopMenu extrastyleclasses="without-swoop">
        <a class="has-circle top-icon left" href="#resources">
            <span class="arrow"></span>
        </a>
        <h5 if="{state.resource.title}">{state.resource.title}</h5>
    </TopMenu>
    <div class="card-content">
        <p if="{state.resource.description}" class="resource-description">
            { state.resource.description }
        </p>
        <template each="{card in state.resource.cards}">
            <Raw
                if="{card.tag === 'raw'}"
                html="{card.content}"
                class="content-block"
            ></Raw>
            <BasicCard
                if="{card.tag === 'basic'}"
                card="{card}"
                class="content-block"
            ></BasicCard>
            <AudioCard
                if="{card.media_type === 'audio'}"
                media="{card}"
                class="content-block"
            ></AudioCard>
            <VideoCard
                if="{card.media_type === 'video'}"
                media="{card}"
                class="content-block"
            ></VideoCard>
            <QuoteCard
                if="{card.tag === 'quote'}"
                card="{card}"
                class="content-block"
            ></QuoteCard>
            <ListCard
                if="{card.tag === 'list'}"
                card="{card}"
                class="content-block"
            ></ListCard>
            <PdfCard
                if="{card.tag === 'pdf'}"
                card="{card}"
                class="content-block"
            ></PdfCard>
        </template>
    </div>
    <script>
        import Raw from "RiotTags/Components/Raw.riot.html";
        import BasicCard from "RiotTags/Components/BasicCard.riot.html";
        import VideoCard from "RiotTags/Lesson/VideoCard.riot.html";
        import AudioCard from "RiotTags/Lesson/AudioCard.riot.html";
        import QuoteCard from "RiotTags/Components/QuoteCard.riot.html";
        import ListCard from "RiotTags/Lesson/ListCard.riot.html";
        import PdfCard from "RiotTags/Lesson/PdfCard.riot.html";
        import Html5Card from "RiotTags/Lesson/Html5Card.riot.html";
        import TopMenu from "RiotTags/Components/TopMenu.riot.html";

        import { getRoute } from "ReduxImpl/Interface";

        function ResourceArticle() {
            return {
                onBeforeMount() {
                    this.state.resource = getRoute().page;
                    this.state.isLoading = !this.state.resource.ready;
                    console.log(this.state.resource);
                },

                onBeforeUpdate() {
                    this.state.isLoading = !this.state.resource.ready;
                },

                checkForPlayableVideos() {
                    this.state.iframes = this.$$("iframe");
                },

                onUpdated() {
                    this.checkForPlayableVideos();
                },

                goBack() {},
            };
        }

        ResourceArticle.components = {
            basiccard: BasicCard,
            quotecard: QuoteCard,
            listcard: ListCard,
            raw: Raw,
            videocard: VideoCard,
            audiocard: AudioCard,
            pdfcard: PdfCard,
            html5card: Html5Card,
            topmenu: TopMenu,
        };

        export default ResourceArticle;
    </script>
</ResourceArticle>
