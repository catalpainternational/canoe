<AllTopicsList>
    <TopMenu extrastyleclasses="with-swoop">
        <h3>{ page.title }</h3>
        <p>{ page.description }</p>
        <div class="filter-copy-container">
            <a
                if="{showTagFilter()}"
                class="has-circle {state.showTagList ? 'show-tags' : ''}"
                onclick="{toggleTagList}"
            >
                <span class="filter-icon"></span>
            </a>
        </div>
        <TagList
            if="{state.showTagList}"
            tags="{state.listOfTags}"
            onTagClick="{onTagClick}"
            selectedTags="{state.selectedTags}"
        ></TagList>
    </TopMenu>
    <div class="content-wrapper">
        <LoadingDots if="{!page.ready}" extrastyleclasses="dark"></LoadingDots>
        <template if="{page.ready}">
            <div class="card-container">
                <Card
                    each="{topic in page.childPages}"
                    title="{topic.title}"
                    link="{topic.loc_hash}"
                    imageUrl="{topic.cardImage}"
                ></Card>
            </div>
        </template>
    </div>

    <script>
        import TopMenu from "RiotTags/Components/TopMenu.riot.html";
        import TagList from "RiotTags/Components/TagList.riot.html";
        import LoadingDots from "RiotTags/Components/LoadingDots.riot.html";
        import Card from "RiotTags/Components/Card.riot.html";

        import { getRoute } from "ReduxImpl/Interface";

        function AllTopicsList() {
            return {
                state: {
                    showTagList: false,
                    listOfTags: [],
                },
                onBeforeMount(props, state) {
                    this.page = getRoute().page;
                },
                showTagFilter() {
                    // we don't know the tags until the page data is available
                    // and we don't show the filter unless we have some tags
                    return (
                        this.page.ready &&
                        this.page.tags &&
                        this.page.tags.length
                    );
                },
                toggleTagList() {
                    this.update({ showTagList: !this.state.showTagList });
                },
            };
        }

        AllTopicsList.components = {
            topmenu: TopMenu,
            taglist: TagList,
            loadingdots: LoadingDots,
            card: Card,
        };

        export default AllTopicsList;
    </script>
</AllTopicsList>
