<CourseOverview>
    <CoursePage
        if="{!state.showExam}"
        page="{props.page}"
    ></CoursePage>
    <CourseExam
        if="{state.showExam}"
        page="{props.page}"
    ></CourseExam>
    <script>
        import CoursePage from "RiotTags/WagtailPages/CoursePage.riot.html";
        import CourseExam from "RiotTags/Lesson/CourseExam.riot.html";
        import { getRoute } from "ReduxImpl/Interface";

        const EXAM_MODULE = "exam";

        function readState() {
            const route = getRoute();
            const state = {
                showExam: route.riotHash === EXAM_MODULE,
            };
            return state;
        }

        function CourseOverview() { return {
            state: {
                ...readState()
            },

            storeListener(previousStoreState, storeState) {
                const newState = readState() 
                if (this.state.showExam !== newState.showExam) {
                    this.update(newState);
                }
            },

            /*
                const examCards = exam.map((card) => {
                    const { id, type, value } = card;
                    const { question, answers } = value;
                    return { id, type, question, answers };
                });
                this.update({ examCards });
            */
        }};

        CourseOverview.components = {
            coursepage: CoursePage,
            courseexam: CourseExam,
        };

        export default CourseOverview;
    </script>
</CourseOverview>
