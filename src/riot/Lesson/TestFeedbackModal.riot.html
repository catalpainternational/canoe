<TestFeedbackModal>
    <div id="modal" class="feedback-modal">
        <div each="{answer in props.selectedAnswers}">
            <h2 if="{props.isQuestionComplete}">{ correctTitleMessage(answer) }</h2>
            <h2 if="{!props.isQuestionComplete}">{ incorrectTitleMessage(answer) }</h2>
        </div>
        <div each="{answer in props.selectedAnswers}">
            <span if="{answer.correct}" class="success"></span>
            <span if="{!answer.correct}" class="warning"></span>
            <p if="{answer.correct}" >{ correctTextMessage(answer) }</p>
            <p if="{!answer.correct}">{ incorrectTextMessage(answer) }</p>
        </div>
        <button if="{props.isQuestionComplete && !props.isLastQuestion}" class="btn-primary" onclick="{ nextTestCard }" translate>Next</button>
        <button if="{props.isQuestionComplete && props.isLastQuestion}" class="btn-primary" onclick="{ completePage }" translate>Finish</button>
        <button if="{!props.isQuestionComplete}" class="btn-primary btn-wrong" onclick="{ () => props.toggleModal(false, {}) }" translate>Try again</button>
    </div>

    <script>
        import { getLessonModuleHash } from "js/Routing";
        import { setComplete } from "Actions/completion";

        export default {
            nextTestCard() {
                this.props.toggleModal(false, {});
                window.scroll(0, 0);
                location.hash = getLessonModuleHash(
                    this.props.lesson.id,
                    this.props.module,
                    this.props.cardIdx
                );
            },

            completePage() {
                this.props.toggleModal(false, {});
                setComplete(this.props.course.slug, this.props.lesson.slug, this.props.module);
                location.hash = getLessonModuleHash(
                    this.props.lesson.id,
                    this.props.module,
                    this.props.cardIdx
                );
            },

            correctTitleMessage(answer) {
                // title for correct answer feedback
                return answer.correct_title 
                ? answer.correct_title
                : gettext("Great");
            },

            correctTextMessage(answer) {
                // text for correct answer feedback
                return answer.correct_text 
                ? answer.correct_text
                : gettext("Well done, keep it up!");
            },

            incorrectTitleMessage(answer) {
                // title for incorrect answer feedback
                return answer.incorrect_title 
                ? answer.incorrect_title
                : gettext("Oops");
            },

            incorrectTextMessage(answer) {
                // text for incorrect answer feedback
                return answer.incorrect_text 
                ? answer.incorrect_text
                : gettext("Read the question more carefully!");
            },
        }
    </script>
</TestFeedbackModal>