<TestPopupModal>
    <PopupModal>
        <span class="{ props.isQuestionComplete ? 'correct-checkmark' : 'incorrect-cross'}"></span>
        <h3>{ props.isQuestionComplete ? correctTitleMessage(props.selectedAnswer) : incorrectTitleMessage(props.selectedAnswer) }</h3>
        <div>
            <p>{ props.isQuestionComplete ? correctTextMessage(props.selectedAnswer) : incorrectTextMessage(props.selectedAnswer) }</p>
        </div>
        <button
            if="{props.isQuestionComplete && !props.isLastQuestion}"
            class="btn-primary"
            onclick="{ nextCard }"
        >{ TRANSLATIONS.next() }</button>
        <button
            if="{props.isQuestionComplete && props.isLastQuestion}"
            class="btn-primary"
            onclick="{ completePage }"
        >{ TRANSLATIONS.finish() }</button>
        <button
            if="{!props.isQuestionComplete}"
            class="btn-primary"
            onclick="{ () => props.toggleModal(false, {}) }"
        >{ TRANSLATIONS.try() }</button>
    </PopupModal>

    <script>
        import { getNextCardsUrl } from "js/Routing";
        import { setComplete } from "Actions/completion";
        import PopupModal from "RiotTags/Components/PopupModal.riot.html";

        export default {
            components: {
                popupmodal: PopupModal,
            },

            TRANSLATIONS: {
                next: () => gettext('Next'),
                finish: () => gettext('Finish'),
                try: () => gettext('Try again'),
            },

            nextCard() {
                this.props.toggleModal(false, {});
                window.scroll(0, 0);
                const nextCard = this.props.lesson.content.cards[this.props.cardNumber];
                location.hash = `${this.props.lesson.loc_hash}:content:${this.props.cardNumber + 1}`;
            },

            completePage() {
                this.props.toggleModal(false, {});
                this.props.lesson.completeSection('content')

                location.hash = this.props.lesson.loc_hash + ":test:feedback";
            },

            correctTitleMessage(selectedAnswer) {
                // title for correct answer feedback
                return selectedAnswer.feedback_title || gettext("Great");
            },

            correctTextMessage(selectedAnswer) {
                // text for correct answer feedback
                return selectedAnswer.feedback_text || gettext("Well done, keep it up!");
            },

            incorrectTitleMessage(selectedAnswer) {
                // title for incorrect answer feedback
                return selectedAnswer.feedback_title || gettext("Oops");
            },

            incorrectTextMessage(selectedAnswer) {
                // text for incorrect answer feedback
                return selectedAnswer.feedback_text || gettext("Read the question more carefully!");
            },
        }
    </script>
</TestPopupModal>
