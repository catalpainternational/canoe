<TopMenu>
    <header if="{!state.isHome}" class="background-{state.color}">
        <a
            if="{!state.isCard && !state.isLessonList && !state.isCourse && !state.isBasePage}"
            class="{state.isSettings ? 'arrow-gray' : 'arrow-white'}"
            onclick="{goBack}"
        ></a>
        <a
            if="{state.isLessonList}"
            class="arrow-white"
            onclick="{backToCoursePage}"
        ></a>
        <a
            if="{state.isCourse}"
            class="arrow-white"
            onclick="{backToHome}"
        ></a>
        <a
            if="{state.isCard}"
            class="cross close-btn"
            onclick="{backToLessonPage}"
        ></a>
        <a
            if="{!state.isBasePage}"
            class="site-logo {state.isSettings ? '' : 'white'}"
            href="#"
        ></a>
        <a if="{!state.isSettings}" class="cog white" href="#settings"></a>
    </header>

    <script>
        import { parseURLHash } from "js/Routing";

        export default {
            state: {
                color: ""
            },

            onBeforeMount(props, state) {
                this.updateState();
            },

            onBeforeUpdate(props, state) {
                this.updateState();
            },

            goBack() {
                window.history.back();
            },

            backToLessonPage() {
                location.hash = "#" + this.props.wagtailPage.data.id;
            },

            backToHome() {
                location.hash = "#";
            },

            backToCoursePage() {
                location.hash = "#" + this.props.wagtailPage.course.id;
            },

            updateState() {
                const [afterTheHash, lessonModule] = parseURLHash();
                this.state.lessonModule = lessonModule;
                this.state.isObjective = this.state.lessonModule === "objectives";
                this.state.isContent = this.state.lessonModule === "content";
                this.state.isTest = this.state.lessonModule === "test";
                this.state.isCard = this.state.isTest || this.state.isContent || this.state.isObjective;
                this.state.isHome = this.props.contentType === "HomePage";
                this.state.isCourse = this.props.contentType === "CoursePage";
                this.state.isNotifications = this.props.contentType === "notifications";
                this.state.isProfile = this.props.contentType === "profile";
                this.state.isSettings = this.props.contentType === "settings";
                this.state.isLessonList = this.props.contentType === "LessonPage" && !this.state.isCard;
                this.state.isBasePage = this.state.isProfile || this.state.isNotifications || this.state.isSettings

                if (this.state.isProfile) {
                    this.state.color = "profile-green";
                } else if (this.state.isNotifications) {
                    this.state.color = "notifications-orange";
                } else {
                    this.state.color = "";
                }
            }
        };
    </script>
</TopMenu>
